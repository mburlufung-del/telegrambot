<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TeleShop Admin Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <div class="min-h-screen">
        <nav class="bg-white border-b border-gray-200 shadow-sm">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between h-16">
                    <div class="flex items-center">
                        <h1 class="text-xl font-bold text-gray-900">ðŸ¤– TeleShop Admin</h1>
                        <div class="ml-6 flex space-x-8">
                            <a href="#" onclick="showSection('dashboard')" class="text-gray-900 px-3 py-2 text-sm font-medium border-b-2 border-indigo-500">Dashboard</a>
                            <a href="#" onclick="showSection('products')" class="text-gray-500 hover:text-gray-700 px-3 py-2 text-sm font-medium">Products</a>
                            <a href="#" onclick="showSection('categories')" class="text-gray-500 hover:text-gray-700 px-3 py-2 text-sm font-medium">Categories</a>
                            <a href="#" onclick="showSection('payments')" class="text-gray-500 hover:text-gray-700 px-3 py-2 text-sm font-medium">Payment Methods</a>
                            <a href="#" onclick="showSection('delivery')" class="text-gray-500 hover:text-gray-700 px-3 py-2 text-sm font-medium">Delivery Options</a>
                            <a href="#" onclick="showSection('orders')" class="text-gray-500 hover:text-gray-700 px-3 py-2 text-sm font-medium">Orders</a>
                            <a href="#" onclick="showSection('inquiries')" class="text-gray-500 hover:text-gray-700 px-3 py-2 text-sm font-medium">Inquiries</a>
                            <a href="#" onclick="showSection('support')" class="text-gray-500 hover:text-gray-700 px-3 py-2 text-sm font-medium">Operator Support</a>
                            <a href="#" onclick="showSection('broadcast')" class="text-gray-500 hover:text-gray-700 px-3 py-2 text-sm font-medium">Broadcast</a>
                            <a href="#" onclick="showSection('settings')" class="text-gray-500 hover:text-gray-700 px-3 py-2 text-sm font-medium">Bot Settings</a>
                        </div>
                    </div>
                    <div class="flex items-center">
                        <span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Bot Online</span>
                    </div>
                </div>
            </div>
        </nav>

        <main class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
            <div id="dashboard-section">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Dashboard Overview</h2>
                <div class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4">
                    <div class="bg-white overflow-hidden shadow rounded-lg">
                        <div class="p-5">
                            <div class="flex items-center">
                                <div class="w-8 h-8 bg-indigo-500 rounded-md flex items-center justify-center">
                                    <span class="text-white font-semibold">ðŸ“¦</span>
                                </div>
                                <div class="ml-5">
                                    <p class="text-sm font-medium text-gray-500">Total Products</p>
                                    <p class="text-lg font-medium text-gray-900" id="total-products">Loading...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white overflow-hidden shadow rounded-lg">
                        <div class="p-5">
                            <div class="flex items-center">
                                <div class="w-8 h-8 bg-green-500 rounded-md flex items-center justify-center">
                                    <span class="text-white font-semibold">ðŸ›’</span>
                                </div>
                                <div class="ml-5">
                                    <p class="text-sm font-medium text-gray-500">Total Orders</p>
                                    <p class="text-lg font-medium text-gray-900" id="total-orders">Loading...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white overflow-hidden shadow rounded-lg">
                        <div class="p-5">
                            <div class="flex items-center">
                                <div class="w-8 h-8 bg-yellow-500 rounded-md flex items-center justify-center">
                                    <span class="text-white font-semibold">ðŸ’¬</span>
                                </div>
                                <div class="ml-5">
                                    <p class="text-sm font-medium text-gray-500">Inquiries</p>
                                    <p class="text-lg font-medium text-gray-900" id="total-inquiries">Loading...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white overflow-hidden shadow rounded-lg">
                        <div class="p-5">
                            <div class="flex items-center">
                                <div class="w-8 h-8 bg-purple-500 rounded-md flex items-center justify-center">
                                    <span class="text-white font-semibold">ðŸ’³</span>
                                </div>
                                <div class="ml-5">
                                    <p class="text-sm font-medium text-gray-500">Payment Methods</p>
                                    <p class="text-lg font-medium text-gray-900" id="total-payments">Loading...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="products-section" style="display: none;">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">Product Management</h2>
                    <button class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-medium" onclick="showAddProductForm()">
                        + Add New Product
                    </button>
                </div>
                
                <!-- Add Product Form -->
                <div id="add-product-form" class="bg-white shadow rounded-lg p-6 mb-6" style="display: none;">
                    <h3 class="text-lg font-semibold mb-4">Add New Product</h3>
                    
                    <!-- Basic Product Information -->
                    <div class="mb-6">
                        <h4 class="text-md font-medium text-gray-800 mb-3">Basic Information</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Product Name</label>
                                <input type="text" id="product-name" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                                <select id="product-category" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                    <option value="">Select Category</option>
                                </select>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                                <textarea id="product-description" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Product Image Upload -->
                    <div class="mb-6">
                        <h4 class="text-md font-medium text-gray-800 mb-3">Product Image</h4>
                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                            <div class="space-y-2">
                                <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                                    <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                </svg>
                                <div class="text-sm text-gray-600">
                                    <button type="button" class="text-indigo-600 hover:text-indigo-500 font-medium" onclick="uploadProductImage()">
                                        Upload image
                                    </button>
                                    or drag and drop
                                </div>
                                <p class="text-xs text-gray-500">PNG, JPG, GIF up to 10MB</p>
                            </div>
                            <input type="file" id="product-image-input" accept="image/*" style="display: none;" onchange="handleImageUpload(event)">
                            <div id="image-preview" class="mt-4 hidden">
                                <img id="preview-img" src="" alt="Product preview" class="mx-auto h-32 w-32 object-cover rounded-lg">
                                <p class="text-sm text-gray-600 mt-2">âœ“ Image uploaded successfully</p>
                                <input type="hidden" id="product-image-url" value="">
                            </div>
                        </div>
                    </div>

                    <!-- Pricing and Stock -->
                    <div class="mb-6">
                        <h4 class="text-md font-medium text-gray-800 mb-3">Pricing & Stock</h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Base Price ($)</label>
                                <input type="number" id="product-price" step="0.01" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Compare At Price ($)</label>
                                <input type="number" id="product-compare-price" step="0.01" min="0" placeholder="Optional" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Stock Quantity</label>
                                <input type="number" id="product-stock" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            </div>
                        </div>
                    </div>

                    <!-- Measurement and Ordering -->
                    <div class="mb-6">
                        <h4 class="text-md font-medium text-gray-800 mb-3">Measurement & Ordering</h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Unit of Measurement</label>
                                <select id="product-unit" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                    <option value="piece">Piece</option>
                                    <option value="kg">Kilogram (kg)</option>
                                    <option value="gram">Gram (g)</option>
                                    <option value="liter">Liter (L)</option>
                                    <option value="ml">Milliliter (ml)</option>
                                    <option value="meter">Meter (m)</option>
                                    <option value="cm">Centimeter (cm)</option>
                                    <option value="inch">Inch</option>
                                    <option value="pack">Pack</option>
                                    <option value="box">Box</option>
                                    <option value="dozen">Dozen</option>
                                    <option value="pair">Pair</option>
                                    <option value="set">Set</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Min Order Quantity</label>
                                <input type="number" id="product-min-qty" min="1" value="1" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Max Order Quantity</label>
                                <input type="number" id="product-max-qty" min="1" placeholder="Optional" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            </div>
                        </div>
                    </div>

                    <!-- Pricing Tiers -->
                    <div class="mb-6">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="text-md font-medium text-gray-800">Bulk Pricing Tiers</h4>
                            <button type="button" class="text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1 rounded-md" onclick="addPricingTier()">
                                + Add Tier
                            </button>
                        </div>
                        <div id="pricing-tiers" class="space-y-2">
                            <p class="text-sm text-gray-500">Add pricing tiers for bulk discounts (optional)</p>
                        </div>
                    </div>

                    <!-- Additional Details -->
                    <div class="mb-6">
                        <h4 class="text-md font-medium text-gray-800 mb-3">Additional Details</h4>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Specifications (JSON format)</label>
                            <textarea id="product-specs" rows="3" placeholder='{"weight": "1kg", "color": "red", "material": "cotton"}' class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                            <p class="text-xs text-gray-500 mt-1">Enter product specifications in JSON format for detailed product information</p>
                        </div>
                    </div>

                    <div class="flex justify-end space-x-3 mt-6">
                        <button class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50" onclick="hideAddProductForm()">Cancel</button>
                        <button class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700" onclick="addProduct()">Add Product</button>
                    </div>
                </div>

                <!-- Edit Product Form -->
                <div id="edit-product-form" class="bg-white shadow rounded-lg p-6 mb-6" style="display: none;">
                    <h3 class="text-lg font-semibold mb-4">Edit Product</h3>
                    <input type="hidden" id="edit-product-id">
                    
                    <!-- Basic Product Information -->
                    <div class="mb-6">
                        <h4 class="text-md font-medium text-gray-800 mb-3">Basic Information</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Product Name</label>
                                <input type="text" id="edit-product-name" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                                <select id="edit-product-category" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                    <option value="">Select Category</option>
                                </select>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                                <textarea id="edit-product-description" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Product Image Upload -->
                    <div class="mb-6">
                        <h4 class="text-md font-medium text-gray-800 mb-3">Product Image</h4>
                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                            <div class="space-y-2">
                                <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                                    <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                </svg>
                                <div class="text-sm text-gray-600">
                                    <button type="button" class="text-indigo-600 hover:text-indigo-500 font-medium" onclick="uploadEditProductImage()">
                                        Upload new image
                                    </button>
                                    or drag and drop
                                </div>
                                <p class="text-xs text-gray-500">PNG, JPG, GIF up to 10MB</p>
                            </div>
                            <input type="file" id="edit-product-image-input" accept="image/*" style="display: none;" onchange="handleEditImageUpload(event)">
                            <div id="edit-image-preview" class="mt-4 hidden">
                                <img id="edit-preview-img" src="" alt="Product preview" class="mx-auto h-32 w-32 object-cover rounded-lg">
                                <p class="text-sm text-gray-600 mt-2">âœ“ Image uploaded successfully</p>
                                <input type="hidden" id="edit-product-image-url" value="">
                            </div>
                            <div id="edit-current-image" class="mt-4 hidden">
                                <p class="text-sm text-gray-600 mb-2">Current image:</p>
                                <img id="edit-current-img" src="" alt="Current product image" class="mx-auto h-32 w-32 object-cover rounded-lg">
                            </div>
                        </div>
                    </div>

                    <!-- Pricing and Stock -->
                    <div class="mb-6">
                        <h4 class="text-md font-medium text-gray-800 mb-3">Pricing & Stock</h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Base Price ($)</label>
                                <input type="number" id="edit-product-price" step="0.01" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Compare At Price ($)</label>
                                <input type="number" id="edit-product-compare-price" step="0.01" min="0" placeholder="Optional" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Stock Quantity</label>
                                <input type="number" id="edit-product-stock" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            </div>
                        </div>
                    </div>

                    <!-- Measurement and Ordering -->
                    <div class="mb-6">
                        <h4 class="text-md font-medium text-gray-800 mb-3">Measurement & Ordering</h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Unit of Measurement</label>
                                <select id="edit-product-unit" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                    <option value="piece">Piece</option>
                                    <option value="kg">Kilogram (kg)</option>
                                    <option value="gram">Gram (g)</option>
                                    <option value="liter">Liter (L)</option>
                                    <option value="ml">Milliliter (ml)</option>
                                    <option value="meter">Meter (m)</option>
                                    <option value="cm">Centimeter (cm)</option>
                                    <option value="inch">Inch</option>
                                    <option value="pack">Pack</option>
                                    <option value="box">Box</option>
                                    <option value="dozen">Dozen</option>
                                    <option value="pair">Pair</option>
                                    <option value="set">Set</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Min Order Quantity</label>
                                <input type="number" id="edit-product-min-qty" min="1" value="1" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Max Order Quantity</label>
                                <input type="number" id="edit-product-max-qty" min="1" placeholder="Optional" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            </div>
                        </div>
                    </div>

                    <!-- Additional Details -->
                    <div class="mb-6">
                        <h4 class="text-md font-medium text-gray-800 mb-3">Additional Details</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Specifications (JSON format)</label>
                                <textarea id="edit-product-specs" rows="3" placeholder='{"weight": "1kg", "color": "red", "material": "cotton"}' class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Product Status</label>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" id="edit-product-active" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                                        <span class="ml-2 text-sm text-gray-700">Product is active</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" id="edit-product-featured" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                                        <span class="ml-2 text-sm text-gray-700">Featured product</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-end space-x-3 mt-6">
                        <button class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50" onclick="hideEditProductForm()">Cancel</button>
                        <button class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700" onclick="updateProduct()">Update Product</button>
                    </div>
                </div>

                <!-- Products List -->
                <div class="bg-white shadow rounded-lg">
                    <div class="px-4 py-5 sm:p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-medium text-gray-900">Products</h3>
                            <button class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded" onclick="loadProducts()">
                                Refresh
                            </button>
                        </div>
                        <div id="products-list">Loading...</div>
                    </div>
                </div>
            </div>

            <!-- Categories Section -->
            <div id="categories-section" style="display: none;">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">Category Management</h2>
                    <button class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-medium" onclick="showAddCategoryForm()">
                        + Add New Category
                    </button>
                </div>
                
                <!-- Add Category Form -->
                <div id="add-category-form" class="bg-white shadow rounded-lg p-6 mb-6" style="display: none;">
                    <h3 class="text-lg font-semibold mb-4">Add New Category</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Category Name</label>
                            <input type="text" id="category-name" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Display Order</label>
                            <input type="number" id="category-order" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                            <textarea id="category-description" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 mt-6">
                        <button class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50" onclick="hideAddCategoryForm()">Cancel</button>
                        <button class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700" onclick="addCategory()">Add Category</button>
                    </div>
                </div>

                <!-- Edit Category Form -->
                <div id="edit-category-form" class="bg-white shadow rounded-lg p-6 mb-6" style="display: none;">
                    <h3 class="text-lg font-semibold mb-4">Edit Category</h3>
                    <input type="hidden" id="edit-category-id">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Category Name</label>
                            <input type="text" id="edit-category-name" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Display Order</label>
                            <input type="number" id="edit-category-display-order" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div class="md:col-span-2">
                            <label class="flex items-center">
                                <input type="checkbox" id="edit-category-active" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                                <span class="ml-2 text-sm text-gray-700">Category is active</span>
                            </label>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 mt-6">
                        <button class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50" onclick="hideEditCategoryForm()">Cancel</button>
                        <button class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700" onclick="updateCategory()">Update Category</button>
                    </div>
                </div>

                <!-- Categories List -->
                <div class="bg-white shadow rounded-lg">
                    <div class="px-4 py-5 sm:p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-medium text-gray-900">Categories</h3>
                            <button class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded" onclick="loadCategories()">
                                Refresh
                            </button>
                        </div>
                        <div id="categories-list">Loading...</div>
                    </div>
                </div>
            </div>

            <div id="payments-section" style="display: none;">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">Payment Methods</h2>
                    <button class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-medium" onclick="showAddPaymentForm()">
                        + Add Payment Method
                    </button>
                </div>
                
                <!-- Add Payment Method Form -->
                <div id="add-payment-form" class="bg-white shadow rounded-lg p-6 mb-6" style="display: none;">
                    <h3 class="text-lg font-semibold mb-4">Add Payment Method</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Method Name</label>
                            <input type="text" id="payment-name" placeholder="e.g., Credit Card, PayPal" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                            <select id="payment-active" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                <option value="true">Active</option>
                                <option value="false">Inactive</option>
                            </select>
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                            <textarea id="payment-description" rows="2" placeholder="Brief description of this payment method" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Payment Instructions</label>
                            <textarea id="payment-info" rows="3" placeholder="Detailed instructions for customers on how to pay using this method" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 mt-6">
                        <button class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50" onclick="hideAddPaymentForm()">Cancel</button>
                        <button class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700" onclick="addPaymentMethod()">Add Method</button>
                    </div>
                </div>

                <!-- Edit Payment Method Form -->
                <div id="edit-payment-form" class="bg-white shadow rounded-lg p-6 mb-6" style="display: none;">
                    <h3 class="text-lg font-semibold mb-4">Edit Payment Method</h3>
                    <input type="hidden" id="edit-payment-id">
                    <div class="grid grid-cols-1 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Payment Method Name</label>
                            <input type="text" id="edit-payment-name" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                            <textarea id="edit-payment-description" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Payment Instructions</label>
                            <textarea id="edit-payment-info" rows="3" placeholder="e.g., Bank account: 1234567890, Sort code: 12-34-56" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                        </div>
                        <div>
                            <label class="flex items-center">
                                <input type="checkbox" id="edit-payment-active" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                                <span class="ml-2 text-sm text-gray-700">Payment method is active</span>
                            </label>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 mt-6">
                        <button class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50" onclick="hideEditPaymentForm()">Cancel</button>
                        <button class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700" onclick="updatePaymentMethod()">Update Payment Method</button>
                    </div>
                </div>

                <!-- Payment Methods List -->
                <div class="bg-white shadow rounded-lg">
                    <div class="px-4 py-5 sm:p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-medium text-gray-900">Available Payment Methods</h3>
                            <button class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded" onclick="loadPaymentMethods()">
                                Refresh
                            </button>
                        </div>
                        <div id="payment-methods-list">Loading...</div>
                    </div>
                </div>
            </div>

            <!-- Delivery Options Section -->
            <div id="delivery-section" style="display: none;">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">Delivery Options</h2>
                    <button class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-medium" onclick="showAddDeliveryForm()">
                        + Add Delivery Option
                    </button>
                </div>
                
                <!-- Add Delivery Method Form -->
                <div id="add-delivery-form" class="bg-white shadow rounded-lg p-6 mb-6" style="display: none;">
                    <h3 class="text-lg font-semibold mb-4">Add Delivery Option</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Method Name</label>
                            <input type="text" id="delivery-name" placeholder="e.g., Standard Shipping" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Price ($)</label>
                            <input type="number" id="delivery-price" step="0.01" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Estimated Days</label>
                            <input type="number" id="delivery-days" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div class="md:col-span-3">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                            <textarea id="delivery-description" rows="2" placeholder="Description of this delivery option" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 mt-6">
                        <button class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50" onclick="hideAddDeliveryForm()">Cancel</button>
                        <button class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700" onclick="addDeliveryMethod()">Add Option</button>
                    </div>
                </div>

                <!-- Edit Delivery Method Form -->
                <div id="edit-delivery-form" class="bg-white shadow rounded-lg p-6 mb-6" style="display: none;">
                    <h3 class="text-lg font-semibold mb-4">Edit Delivery Method</h3>
                    <input type="hidden" id="edit-delivery-id">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Delivery Method Name</label>
                            <input type="text" id="edit-delivery-name" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Price ($)</label>
                            <input type="number" id="edit-delivery-price" step="0.01" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Estimated Delivery Days</label>
                            <input type="number" id="edit-delivery-days" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div class="flex items-center">
                            <label class="flex items-center">
                                <input type="checkbox" id="edit-delivery-active" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                                <span class="ml-2 text-sm text-gray-700">Delivery method is active</span>
                            </label>
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                            <textarea id="edit-delivery-description" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 mt-6">
                        <button class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50" onclick="hideEditDeliveryForm()">Cancel</button>
                        <button class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700" onclick="updateDeliveryMethod()">Update Delivery Method</button>
                    </div>
                </div>

                <!-- Delivery Methods List -->
                <div class="bg-white shadow rounded-lg">
                    <div class="px-4 py-5 sm:p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-medium text-gray-900">Delivery Options</h3>
                            <button class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded" onclick="loadDeliveryMethods()">
                                Refresh
                            </button>
                        </div>
                        <div id="delivery-methods-list">Loading...</div>
                    </div>
                </div>
            </div>

            <!-- Orders Section -->
            <div id="orders-section" style="display: none;">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Order Management</h2>
                <div class="bg-white shadow rounded-lg">
                    <div class="px-4 py-5 sm:p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-medium text-gray-900">Recent Orders</h3>
                            <button class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded" onclick="loadOrders()">
                                Refresh
                            </button>
                        </div>
                        <div id="orders-list">Loading...</div>
                    </div>
                </div>
            </div>

            <!-- Inquiries Section -->
            <div id="inquiries-section" style="display: none;">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Customer Inquiries</h2>
                <div class="bg-white shadow rounded-lg">
                    <div class="px-4 py-5 sm:p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-medium text-gray-900">Recent Inquiries</h3>
                            <div class="flex space-x-3">
                                <span id="unread-badge" class="bg-red-100 text-red-800 text-xs font-medium px-2.5 py-0.5 rounded-full">0 Unread</span>
                                <button class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded" onclick="loadInquiries()">
                                    Refresh
                                </button>
                            </div>
                        </div>
                        <div id="inquiries-list">Loading...</div>
                    </div>
                </div>
            </div>

            <!-- Operator Support Section -->
            <div id="support-section" style="display: none;">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Operator Support Management</h2>
                
                <!-- Bot Operators Management -->
                <div class="bg-white shadow rounded-lg mb-6">
                    <div class="px-4 py-5 sm:p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg leading-6 font-medium text-gray-900">Bot Operators & Contact Information</h3>
                            <button onclick="showAddOperatorModal()" class="px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                Add Operator
                            </button>
                        </div>
                        
                        <!-- Operators list -->
                        <div id="operators-list" class="space-y-3">
                            <div class="text-center py-8">
                                <div class="text-sm text-gray-500">Loading operators...</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Support Stats -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                    <div class="bg-white overflow-hidden shadow rounded-lg">
                        <div class="p-5">
                            <div class="flex items-center">
                                <div class="flex-shrink-0">
                                    <div class="flex items-center justify-center h-8 w-8 rounded-md bg-yellow-500 text-white">
                                        <span class="text-sm font-bold" id="waiting-sessions-count">0</span>
                                    </div>
                                </div>
                                <div class="ml-5 w-0 flex-1">
                                    <dl>
                                        <dt class="text-sm font-medium text-gray-500 truncate">Waiting Sessions</dt>
                                        <dd class="text-lg font-medium text-gray-900">Queue</dd>
                                    </dl>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white overflow-hidden shadow rounded-lg">
                        <div class="p-5">
                            <div class="flex items-center">
                                <div class="flex-shrink-0">
                                    <div class="flex items-center justify-center h-8 w-8 rounded-md bg-green-500 text-white">
                                        <span class="text-sm font-bold" id="active-sessions-count">0</span>
                                    </div>
                                </div>
                                <div class="ml-5 w-0 flex-1">
                                    <dl>
                                        <dt class="text-sm font-medium text-gray-500 truncate">Active Sessions</dt>
                                        <dd class="text-lg font-medium text-gray-900">Live</dd>
                                    </dl>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white overflow-hidden shadow rounded-lg">
                        <div class="p-5">
                            <div class="flex items-center">
                                <div class="flex-shrink-0">
                                    <div class="flex items-center justify-center h-8 w-8 rounded-md bg-blue-500 text-white">
                                        <span class="text-sm font-bold" id="resolved-sessions-count">0</span>
                                    </div>
                                </div>
                                <div class="ml-5 w-0 flex-1">
                                    <dl>
                                        <dt class="text-sm font-medium text-gray-500 truncate">Resolved Today</dt>
                                        <dd class="text-lg font-medium text-gray-900">Completed</dd>
                                    </dl>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white overflow-hidden shadow rounded-lg">
                        <div class="p-5">
                            <div class="flex items-center">
                                <div class="flex-shrink-0">
                                    <div class="flex items-center justify-center h-8 w-8 rounded-md bg-purple-500 text-white">
                                        <span class="text-sm font-bold" id="avg-response-time">0m</span>
                                    </div>
                                </div>
                                <div class="ml-5 w-0 flex-1">
                                    <dl>
                                        <dt class="text-sm font-medium text-gray-500 truncate">Avg Response Time</dt>
                                        <dd class="text-lg font-medium text-gray-900">Performance</dd>
                                    </dl>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Session Filters -->
                <div class="bg-white shadow rounded-lg mb-6">
                    <div class="px-4 py-5 sm:p-6">
                        <div class="flex flex-wrap gap-4 items-center justify-between">
                            <div class="flex gap-2">
                                <button onclick="filterSessions('all')" id="filter-all" class="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                    All Sessions
                                </button>
                                <button onclick="filterSessions('waiting')" id="filter-waiting" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                    Waiting
                                </button>
                                <button onclick="filterSessions('active')" id="filter-active" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                    Active
                                </button>
                                <button onclick="filterSessions('resolved')" id="filter-resolved" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                    Resolved
                                </button>
                            </div>
                            <button onclick="refreshSessions()" class="px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                â†» Refresh
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Sessions List -->
                <div class="bg-white shadow rounded-lg">
                    <div class="px-4 py-5 sm:p-6">
                        <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">Support Sessions</h3>
                        <div id="sessions-list" class="space-y-4">
                            <!-- Sessions will be loaded here -->
                            <p class="text-gray-500 text-center py-8">Loading sessions...</p>
                        </div>
                    </div>
                </div>

                <!-- Session Details Modal -->
                <div id="session-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full" style="display: none;">
                    <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white">
                        <div class="mt-3">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-medium text-gray-900" id="session-modal-title">Session Details</h3>
                                <button onclick="closeSessionModal()" class="text-gray-400 hover:text-gray-600">
                                    <span class="sr-only">Close</span>
                                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                                    </svg>
                                </button>
                            </div>
                            <div id="session-modal-content" class="space-y-4">
                                <!-- Session details will be loaded here -->
                            </div>
                            <div class="flex justify-end space-x-3 mt-6">
                                <button onclick="closeSessionModal()" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50">
                                    Close
                                </button>
                                <div id="session-modal-actions">
                                    <!-- Action buttons will be added here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Broadcast Section -->
            <div id="broadcast-section" style="display: none;">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Broadcast Message</h2>
                
                <!-- Broadcast Form -->
                <div class="bg-white shadow rounded-lg p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-4">Send Message to All Bot Users</h3>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Message Text</label>
                            <textarea id="broadcast-message" rows="4" placeholder="Enter your broadcast message here..." class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Image (Optional)</label>
                            <div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md">
                                <div class="space-y-1 text-center">
                                    <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48" aria-hidden="true">
                                        <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                    </svg>
                                    <div class="flex text-sm text-gray-600">
                                        <label for="broadcast-image" class="relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500">
                                            <span>Upload an image</span>
                                            <input id="broadcast-image" name="broadcast-image" type="file" accept="image/*" class="sr-only" onchange="previewBroadcastImage(this)">
                                        </label>
                                        <p class="pl-1">or drag and drop</p>
                                    </div>
                                    <p class="text-xs text-gray-500">PNG, JPG, GIF up to 10MB</p>
                                </div>
                            </div>
                            
                            <!-- Image Preview -->
                            <div id="broadcast-image-preview" class="mt-4" style="display: none;">
                                <div class="relative">
                                    <img id="preview-img" src="" alt="Preview" class="max-w-xs max-h-48 rounded-lg shadow">
                                    <button type="button" onclick="removeBroadcastImage()" class="absolute top-2 right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600">Ã—</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="border-t pt-4">
                            <div class="flex justify-between items-center">
                                <div class="text-sm text-gray-600">
                                    <span id="user-count">Loading user count...</span>
                                </div>
                                <div class="space-x-3">
                                    <button type="button" onclick="previewBroadcast()" class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">
                                        Preview
                                    </button>
                                    <button type="button" onclick="sendBroadcast()" class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700">
                                        Send Broadcast
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Preview Section -->
                <div id="broadcast-preview" class="bg-white shadow rounded-lg p-6 mb-6" style="display: none;">
                    <h3 class="text-lg font-semibold mb-4">Message Preview</h3>
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <div id="preview-content">
                            <!-- Preview will be populated here -->
                        </div>
                    </div>
                </div>
                
                <!-- Broadcast History -->
                <div class="bg-white shadow rounded-lg">
                    <div class="px-4 py-5 sm:p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-medium text-gray-900">Recent Broadcasts</h3>
                            <button class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded" onclick="loadBroadcastHistory()">
                                Refresh
                            </button>
                        </div>
                        <div id="broadcast-history">Loading...</div>
                    </div>
                </div>
            </div>

            <!-- Bot Settings Section -->
            <div id="settings-section" style="display: none;">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Bot Settings</h2>
                <div class="bg-white shadow rounded-lg">
                    <div class="px-4 py-5 sm:p-6">
                        <div class="space-y-6">
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 mb-4">Bot Configuration</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Welcome Message</label>
                                        <textarea id="welcome-message" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Store Name</label>
                                        <input type="text" id="store-name" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                    </div>
                                </div>
                                <div class="mt-4">
                                    <button class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded" onclick="updateBotSettings()">
                                        Update Settings
                                    </button>
                                </div>
                            </div>
                            
                            <div class="border-t pt-6">
                                <h3 class="text-lg font-medium text-gray-900 mb-4">Bot Status</h3>
                                <div class="flex space-x-3">
                                    <button class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded" onclick="checkBotStatus()">
                                        Check Status
                                    </button>
                                    <button class="bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded" onclick="restartBot()">
                                        Restart Bot
                                    </button>
                                </div>
                                <div id="bot-status-info" class="mt-4"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        function showSection(section) {
            const sections = ['dashboard', 'products', 'categories', 'payments', 'delivery', 'orders', 'support', 'broadcast', 'settings'];
            sections.forEach(s => {
                const element = document.getElementById(s + '-section');
                if (element) element.style.display = 'none';
                // Update nav styling
                const navLink = document.querySelector(`a[onclick="showSection('${s}')"]`);
                if (navLink) {
                    navLink.className = 'text-gray-500 hover:text-gray-700 px-3 py-2 text-sm font-medium';
                }
            });
            
            const targetSection = document.getElementById(section + '-section');
            if (targetSection) {
                targetSection.style.display = 'block';
                // Update active nav styling
                const activeLink = document.querySelector(`a[onclick="showSection('${section}')"]`);
                if (activeLink) {
                    activeLink.className = 'text-gray-900 px-3 py-2 text-sm font-medium border-b-2 border-indigo-500';
                }
                
                // Load data for the section
                if (section === 'products') {
                    loadProducts();
                    loadCategoriesForDropdown();
                } else if (section === 'categories') {
                    loadCategories();
                } else if (section === 'payments') {
                    loadPaymentMethods();
                } else if (section === 'delivery') {
                    loadDeliveryMethods();
                } else if (section === 'orders') {
                    loadOrders();
                } else if (section === 'inquiries') {
                    loadInquiries();
                } else if (section === 'broadcast') {
                    loadUserCount();
                    loadBroadcastHistory();
                } else if (section === 'settings') {
                    loadBotSettings();
                }
            }
        }

        // Form visibility functions
        function showAddProductForm() {
            document.getElementById('add-product-form').style.display = 'block';
            loadCategoriesForDropdown();
        }
        function hideAddProductForm() {
            document.getElementById('add-product-form').style.display = 'none';
            clearProductForm();
        }
        
        function showEditProductForm() {
            document.getElementById('edit-product-form').style.display = 'block';
            loadCategoriesForEditDropdown();
        }
        
        function hideEditProductForm() {
            document.getElementById('edit-product-form').style.display = 'none';
            clearEditProductForm();
        }
        
        function clearProductForm() {
            // Clear basic fields
            document.getElementById('product-name').value = '';
            document.getElementById('product-description').value = '';
            document.getElementById('product-price').value = '';
            document.getElementById('product-compare-price').value = '';
            document.getElementById('product-stock').value = '';
            document.getElementById('product-unit').value = 'piece';
            document.getElementById('product-min-qty').value = '1';
            document.getElementById('product-max-qty').value = '';
            document.getElementById('product-category').value = '';
            document.getElementById('product-specs').value = '';
            
            // Clear image upload
            document.getElementById('product-image-input').value = '';
            document.getElementById('product-image-url').value = '';
            document.getElementById('image-preview').classList.add('hidden');
            
            // Clear pricing tiers
            document.getElementById('pricing-tiers').innerHTML = '<p class="text-sm text-gray-500">Add pricing tiers for bulk discounts (optional)</p>';
            tierCounter = 0;
        }
        function showAddCategoryForm() {
            document.getElementById('add-category-form').style.display = 'block';
        }
        function hideAddCategoryForm() {
            document.getElementById('add-category-form').style.display = 'none';
            clearCategoryForm();
        }
        
        function showEditCategoryForm() {
            document.getElementById('edit-category-form').style.display = 'block';
        }
        
        function hideEditCategoryForm() {
            document.getElementById('edit-category-form').style.display = 'none';
            clearEditCategoryForm();
        }
        function showAddPaymentForm() {
            document.getElementById('add-payment-form').style.display = 'block';
        }
        function hideAddPaymentForm() {
            document.getElementById('add-payment-form').style.display = 'none';
            clearPaymentForm();
        }
        
        function showEditPaymentForm() {
            document.getElementById('edit-payment-form').style.display = 'block';
        }
        
        function hideEditPaymentForm() {
            document.getElementById('edit-payment-form').style.display = 'none';
            clearEditPaymentForm();
        }
        function showAddDeliveryForm() {
            document.getElementById('add-delivery-form').style.display = 'block';
        }
        function hideAddDeliveryForm() {
            document.getElementById('add-delivery-form').style.display = 'none';
            clearDeliveryForm();
        }
        
        function showEditDeliveryForm() {
            document.getElementById('edit-delivery-form').style.display = 'block';
        }
        
        function hideEditDeliveryForm() {
            document.getElementById('edit-delivery-form').style.display = 'none';
            clearEditDeliveryForm();
        }

        async function loadDashboardData() {
            try {
                const [products, orders, inquiries, payments] = await Promise.all([
                    fetch('/api/products').then(r => r.json()),
                    fetch('/api/orders').then(r => r.json()),
                    fetch('/api/inquiries').then(r => r.json()),
                    fetch('/api/payment-methods').then(r => r.json())
                ]);

                document.getElementById('total-products').textContent = products.length;
                document.getElementById('total-orders').textContent = orders.length;
                document.getElementById('total-inquiries').textContent = inquiries.length;
                document.getElementById('total-payments').textContent = payments.length;
            } catch (error) {
                console.error('Error loading dashboard data:', error);
            }
        }

        async function loadProducts() {
            try {
                const response = await fetch('/api/products');
                const products = await response.json();
                const productsList = document.getElementById('products-list');
                
                if (products.length === 0) {
                    productsList.innerHTML = '<p class="text-gray-500">No products found</p>';
                    return;
                }

                let tableHTML = '<table class="min-w-full"><thead><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Image</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Name</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Price</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Stock</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Unit</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Actions</th></tr></thead><tbody>';
                
                products.forEach(product => {
                    // Image column
                    let imageHtml = '<div class="h-12 w-12 flex-shrink-0">';
                    if (product.imageUrl) {
                        imageHtml += '<img class="h-12 w-12 rounded-lg object-cover" src="' + product.imageUrl + '" alt="' + product.name + '">';
                    } else {
                        imageHtml += '<div class="h-12 w-12 rounded-lg bg-gray-200 flex items-center justify-center"><span class="text-gray-400 text-xs">No image</span></div>';
                    }
                    imageHtml += '</div>';
                    
                    // Status display
                    const statusBadge = '<span class="px-2 py-1 text-xs font-semibold rounded-full ' + (product.isActive ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800') + '">' + (product.isActive ? 'Active' : 'Inactive') + '</span>';
                    
                    // Action buttons
                    const actionButtons = '<div class="flex space-x-2">' +
                        '<button class="text-indigo-600 hover:text-indigo-900 text-sm font-medium" onclick="editProduct(\'' + product.id + '\')">Edit</button>' +
                        '<button class="text-red-600 hover:text-red-900 text-sm font-medium" onclick="deleteProduct(\'' + product.id + '\')">Delete</button>' +
                        '</div>';
                    
                    tableHTML += '<tr>' +
                        '<td class="px-6 py-4">' + imageHtml + '</td>' +
                        '<td class="px-6 py-4 text-sm font-medium text-gray-900">' + product.name + '</td>' +
                        '<td class="px-6 py-4 text-sm text-gray-500">$' + product.price + '</td>' +
                        '<td class="px-6 py-4 text-sm text-gray-500">' + product.stock + ' ' + product.unit + '</td>' +
                        '<td class="px-6 py-4 text-sm text-gray-500">' + product.unit + '</td>' +
                        '<td class="px-6 py-4">' + statusBadge + '</td>' +
                        '<td class="px-6 py-4">' + actionButtons + '</td>' +
                        '</tr>';
                });
                
                tableHTML += '</tbody></table>';
                productsList.innerHTML = tableHTML;
            } catch (error) {
                document.getElementById('products-list').innerHTML = '<p class="text-red-500">Error loading products</p>';
            }
        }

        async function loadPaymentMethods() {
            try {
                const response = await fetch('/api/payment-methods');
                const methods = await response.json();
                const methodsList = document.getElementById('payment-methods-list');
                
                if (methods.length === 0) {
                    methodsList.innerHTML = '<p class="text-gray-500">No payment methods configured</p>';
                    return;
                }

                let html = '';
                methods.forEach(method => {
                    // Action buttons
                    const actionButtons = '<div class="flex space-x-2 mt-2">' +
                        '<button class="text-indigo-600 hover:text-indigo-900 text-sm font-medium" onclick="editPaymentMethod(\'' + method.id + '\')">Edit</button>' +
                        '<button class="text-red-600 hover:text-red-900 text-sm font-medium" onclick="deletePaymentMethod(\'' + method.id + '\')">Delete</button>' +
                        '</div>';
                    
                    html += '<div class="border rounded-lg p-4 mb-4"><div class="flex justify-between items-start"><div><h4 class="font-semibold text-lg">' + method.name + '</h4>';
                    if (method.description) html += '<p class="text-gray-600 text-sm">' + method.description + '</p>';
                    if (method.paymentInfo) html += '<div class="mt-2"><strong>Payment Info:</strong><br><div class="bg-gray-50 p-2 rounded text-sm">' + method.paymentInfo + '</div></div>';
                    html += actionButtons + '</div><span class="px-2 py-1 text-xs font-semibold rounded-full ' + (method.isActive ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800') + '">' + (method.isActive ? 'Active' : 'Inactive') + '</span></div></div>';
                });
                
                methodsList.innerHTML = html;
            } catch (error) {
                document.getElementById('payment-methods-list').innerHTML = '<p class="text-red-500">Error loading payment methods</p>';
            }
        }

        // Image upload functions
        function uploadProductImage() {
            document.getElementById('product-image-input').click();
        }

        async function handleImageUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            if (file.size > 10 * 1024 * 1024) { // 10MB limit
                showNotification('File size must be less than 10MB', 'error');
                return;
            }

            try {
                // Get upload URL from server
                const uploadResponse = await fetch('/api/objects/upload', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                const { uploadURL } = await uploadResponse.json();

                // Upload file to object storage
                const fileResponse = await fetch(uploadURL, {
                    method: 'PUT',
                    body: file,
                    headers: {
                        'Content-Type': file.type
                    }
                });

                if (fileResponse.ok) {
                    // Extract object path from upload URL
                    const objectPath = '/objects/' + uploadURL.split('/').pop().split('?')[0];
                    
                    // Show preview
                    const preview = document.getElementById('image-preview');
                    const previewImg = document.getElementById('preview-img');
                    previewImg.src = URL.createObjectURL(file);
                    document.getElementById('product-image-url').value = objectPath;
                    preview.classList.remove('hidden');
                    
                    showNotification('Image uploaded successfully!', 'success');
                } else {
                    showNotification('Failed to upload image', 'error');
                }
            } catch (error) {
                console.error('Upload error:', error);
                showNotification('Error uploading image', 'error');
            }
        }

        // Pricing tier management
        let tierCounter = 0;
        function addPricingTier() {
            tierCounter++;
            const tiersDiv = document.getElementById('pricing-tiers');
            
            if (tierCounter === 1) {
                tiersDiv.innerHTML = ''; // Clear the placeholder text
            }

            const tierHTML = `
                <div class="border rounded-lg p-3 bg-gray-50" id="tier-${tierCounter}">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-3 items-end">
                        <div>
                            <label class="block text-xs font-medium text-gray-700 mb-1">Min Quantity</label>
                            <input type="number" class="tier-min-qty w-full px-2 py-1 text-sm border border-gray-300 rounded-md" min="1" required>
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-700 mb-1">Max Quantity</label>
                            <input type="number" class="tier-max-qty w-full px-2 py-1 text-sm border border-gray-300 rounded-md" min="1" placeholder="Optional">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-700 mb-1">Price ($)</label>
                            <input type="number" class="tier-price w-full px-2 py-1 text-sm border border-gray-300 rounded-md" step="0.01" min="0" required>
                        </div>
                        <div>
                            <button type="button" class="text-red-600 hover:text-red-800 text-sm px-2 py-1" onclick="removePricingTier(${tierCounter})">
                                Remove
                            </button>
                        </div>
                    </div>
                </div>
            `;
            tiersDiv.insertAdjacentHTML('beforeend', tierHTML);
        }

        function removePricingTier(id) {
            const tierElement = document.getElementById(`tier-${id}`);
            tierElement.remove();
            
            // If no tiers left, show placeholder
            const tiersDiv = document.getElementById('pricing-tiers');
            if (tiersDiv.children.length === 0) {
                tiersDiv.innerHTML = '<p class="text-sm text-gray-500">Add pricing tiers for bulk discounts (optional)</p>';
                tierCounter = 0;
            }
        }

        function collectPricingTiers() {
            const tiers = [];
            const tierElements = document.querySelectorAll('#pricing-tiers .border');
            
            tierElements.forEach(tierElement => {
                const minQty = parseInt(tierElement.querySelector('.tier-min-qty').value);
                const maxQty = tierElement.querySelector('.tier-max-qty').value;
                const price = parseFloat(tierElement.querySelector('.tier-price').value);
                
                if (minQty && price) {
                    tiers.push({
                        minQuantity: minQty,
                        maxQuantity: maxQty ? parseInt(maxQty) : null,
                        price: price,
                        isActive: true
                    });
                }
            });
            
            return tiers;
        }

        // Enhanced add product function
        async function addProduct() {
            // Collect basic product data
            const productData = {
                name: document.getElementById('product-name').value,
                description: document.getElementById('product-description').value,
                price: parseFloat(document.getElementById('product-price').value),
                compareAtPrice: document.getElementById('product-compare-price').value ? 
                    parseFloat(document.getElementById('product-compare-price').value) : null,
                stock: parseInt(document.getElementById('product-stock').value),
                unit: document.getElementById('product-unit').value,
                minOrderQuantity: parseInt(document.getElementById('product-min-qty').value) || 1,
                maxOrderQuantity: document.getElementById('product-max-qty').value ? 
                    parseInt(document.getElementById('product-max-qty').value) : null,
                categoryId: document.getElementById('product-category').value || null,
                imageUrl: document.getElementById('product-image-url').value || null,
                specifications: document.getElementById('product-specs').value || '{}',
                isActive: true,
                isFeatured: false
            };

            // Validate required fields
            if (!productData.name || !productData.description || !productData.price || productData.stock < 0) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }

            try {
                JSON.parse(productData.specifications); // Validate JSON
                
                // Create the product first
                const response = await fetch('/api/products', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(productData)
                });
                
                if (response.ok) {
                    const createdProduct = await response.json();
                    
                    // Add pricing tiers if any
                    const pricingTiers = collectPricingTiers();
                    if (pricingTiers.length > 0) {
                        for (const tier of pricingTiers) {
                            tier.productId = createdProduct.id;
                            await fetch('/api/pricing-tiers', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(tier)
                            });
                        }
                    }
                    
                    hideAddProductForm();
                    loadProducts();
                    loadDashboardData();
                    showNotification('Product added successfully with all features!', 'success');
                } else {
                    const errorData = await response.json();
                    showNotification(`Error adding product: ${errorData.message || 'Unknown error'}`, 'error');
                }
            } catch (error) {
                console.error('Error adding product:', error);
                showNotification('Invalid JSON in specifications or server error', 'error');
            }
        }

        async function addCategory() {
            const categoryData = {
                name: document.getElementById('category-name').value,
                description: document.getElementById('category-description').value,
                displayOrder: parseInt(document.getElementById('category-order').value) || 0
            };

            try {
                const response = await fetch('/api/categories', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(categoryData)
                });
                
                if (response.ok) {
                    hideAddCategoryForm();
                    loadCategories();
                    loadDashboardData();
                    showNotification('Category added successfully!', 'success');
                } else {
                    showNotification('Error adding category', 'error');
                }
            } catch (error) {
                showNotification('Error adding category', 'error');
            }
        }

        async function addPaymentMethod() {
            const paymentData = {
                name: document.getElementById('payment-name').value,
                description: document.getElementById('payment-description').value,
                paymentInfo: document.getElementById('payment-info').value,
                isActive: document.getElementById('payment-active').value === 'true'
            };

            try {
                const response = await fetch('/api/payment-methods', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(paymentData)
                });
                
                if (response.ok) {
                    hideAddPaymentForm();
                    loadPaymentMethods();
                    loadDashboardData();
                    showNotification('Payment method added successfully!', 'success');
                } else {
                    showNotification('Error adding payment method', 'error');
                }
            } catch (error) {
                showNotification('Error adding payment method', 'error');
            }
        }

        async function addDeliveryMethod() {
            const deliveryData = {
                name: document.getElementById('delivery-name').value,
                price: parseFloat(document.getElementById('delivery-price').value),
                estimatedDays: parseInt(document.getElementById('delivery-days').value),
                description: document.getElementById('delivery-description').value
            };

            try {
                const response = await fetch('/api/delivery-methods', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(deliveryData)
                });
                
                if (response.ok) {
                    hideAddDeliveryForm();
                    loadDeliveryMethods();
                    showNotification('Delivery option added successfully!', 'success');
                } else {
                    showNotification('Error adding delivery option', 'error');
                }
            } catch (error) {
                showNotification('Error adding delivery option', 'error');
            }
        }

        // Load additional data functions
        async function loadCategories() {
            try {
                const response = await fetch('/api/categories');
                const categories = await response.json();
                const categoriesList = document.getElementById('categories-list');
                
                if (categories.length === 0) {
                    categoriesList.innerHTML = '<p class="text-gray-500">No categories found</p>';
                    return;
                }

                let tableHTML = '<table class="min-w-full"><thead><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Name</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Order</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Products</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Actions</th></tr></thead><tbody>';
                
                categories.forEach(category => {
                    // Status display
                    const statusBadge = '<span class="px-2 py-1 text-xs font-semibold rounded-full ' + (category.isActive ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800') + '">' + (category.isActive ? 'Active' : 'Inactive') + '</span>';
                    
                    // Action buttons
                    const actionButtons = '<div class="flex space-x-2">' +
                        '<button class="text-indigo-600 hover:text-indigo-900 text-sm font-medium" onclick="editCategory(\'' + category.id + '\')">Edit</button>' +
                        '<button class="text-red-600 hover:text-red-900 text-sm font-medium" onclick="deleteCategory(\'' + category.id + '\')">Delete</button>' +
                        '</div>';
                    
                    tableHTML += '<tr>' +
                        '<td class="px-6 py-4 text-sm font-medium text-gray-900">' + category.name + '</td>' +
                        '<td class="px-6 py-4 text-sm text-gray-500">' + category.displayOrder + '</td>' +
                        '<td class="px-6 py-4">' + statusBadge + '</td>' +
                        '<td class="px-6 py-4 text-sm text-gray-500">' + (category.products || 0) + '</td>' +
                        '<td class="px-6 py-4">' + actionButtons + '</td>' +
                        '</tr>';
                });
                
                tableHTML += '</tbody></table>';
                categoriesList.innerHTML = tableHTML;
            } catch (error) {
                document.getElementById('categories-list').innerHTML = '<p class="text-red-500">Error loading categories</p>';
            }
        }

        async function loadCategoriesForDropdown() {
            try {
                const response = await fetch('/api/categories');
                const categories = await response.json();
                const categorySelect = document.getElementById('product-category');
                
                categorySelect.innerHTML = '<option value="">Select Category</option>';
                categories.forEach(category => {
                    if (category.isActive) {
                        categorySelect.innerHTML += '<option value="' + category.id + '">' + category.name + '</option>';
                    }
                });
            } catch (error) {
                console.error('Error loading categories for dropdown:', error);
            }
        }

        async function loadDeliveryMethods() {
            try {
                const response = await fetch('/api/delivery-methods');
                const methods = await response.json();
                const methodsList = document.getElementById('delivery-methods-list');
                
                if (methods.length === 0) {
                    methodsList.innerHTML = '<p class="text-gray-500">No delivery options configured</p>';
                    return;
                }

                let tableHTML = '<table class="min-w-full"><thead><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Method</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Price</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Est. Days</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Actions</th></tr></thead><tbody>';
                
                methods.forEach(method => {
                    // Status display
                    const statusBadge = '<span class="px-2 py-1 text-xs font-semibold rounded-full ' + (method.isActive ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800') + '">' + (method.isActive ? 'Active' : 'Inactive') + '</span>';
                    
                    // Action buttons
                    const actionButtons = '<div class="flex space-x-2">' +
                        '<button class="text-indigo-600 hover:text-indigo-900 text-sm font-medium" onclick="editDeliveryMethod(\'' + method.id + '\')">Edit</button>' +
                        '<button class="text-red-600 hover:text-red-900 text-sm font-medium" onclick="deleteDeliveryMethod(\'' + method.id + '\')">Delete</button>' +
                        '</div>';
                    
                    tableHTML += '<tr>' +
                        '<td class="px-6 py-4 text-sm font-medium text-gray-900">' + method.name + '</td>' +
                        '<td class="px-6 py-4 text-sm text-gray-500">$' + method.price + '</td>' +
                        '<td class="px-6 py-4 text-sm text-gray-500">' + method.estimatedDays + ' days</td>' +
                        '<td class="px-6 py-4">' + statusBadge + '</td>' +
                        '<td class="px-6 py-4">' + actionButtons + '</td>' +
                        '</tr>';
                });
                
                tableHTML += '</tbody></table>';
                methodsList.innerHTML = tableHTML;
            } catch (error) {
                document.getElementById('delivery-methods-list').innerHTML = '<p class="text-red-500">Error loading delivery methods</p>';
            }
        }

        async function loadOrders() {
            try {
                const response = await fetch('/api/orders');
                const orders = await response.json();
                const ordersList = document.getElementById('orders-list');
                
                if (orders.length === 0) {
                    ordersList.innerHTML = '<p class="text-gray-500">No orders found</p>';
                    return;
                }

                let tableHTML = '<table class="min-w-full"><thead><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Order ID</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Customer</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Total</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Date</th></tr></thead><tbody>';
                
                orders.forEach(order => {
                    const date = new Date(order.createdAt).toLocaleDateString();
                    tableHTML += '<tr><td class="px-6 py-4 text-sm font-medium text-gray-900">#' + order.id + '</td><td class="px-6 py-4 text-sm text-gray-500">' + order.customerName + '</td><td class="px-6 py-4 text-sm text-gray-500">$' + order.totalAmount + '</td><td class="px-6 py-4"><span class="px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800">' + order.status + '</span></td><td class="px-6 py-4 text-sm text-gray-500">' + date + '</td></tr>';
                });
                
                tableHTML += '</tbody></table>';
                ordersList.innerHTML = tableHTML;
            } catch (error) {
                document.getElementById('orders-list').innerHTML = '<p class="text-red-500">Error loading orders</p>';
            }
        }

        async function loadInquiries() {
            try {
                const [inquiriesResponse, unreadResponse] = await Promise.all([
                    fetch('/api/inquiries'),
                    fetch('/api/inquiries/unread-count')
                ]);
                
                const inquiries = await inquiriesResponse.json();
                const unreadData = await unreadResponse.json();
                
                const inquiriesList = document.getElementById('inquiries-list');
                const unreadBadge = document.getElementById('unread-badge');
                
                // Update unread badge
                unreadBadge.textContent = unreadData.count + ' Unread';
                unreadBadge.className = unreadData.count > 0 ? 
                    'bg-red-100 text-red-800 text-xs font-medium px-2.5 py-0.5 rounded-full' :
                    'bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded-full';
                
                if (inquiries.length === 0) {
                    inquiriesList.innerHTML = '<p class="text-gray-500">No inquiries found</p>';
                    return;
                }

                let tableHTML = '<table class="min-w-full"><thead><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Customer</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Message</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Date</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Contact</th></tr></thead><tbody>';
                
                inquiries.forEach(inquiry => {
                    const date = new Date(inquiry.createdAt).toLocaleDateString();
                    const time = new Date(inquiry.createdAt).toLocaleTimeString();
                    const isUnread = !inquiry.isRead;
                    const statusClass = isUnread ? 'bg-red-100 text-red-800' : 'bg-green-100 text-green-800';
                    const statusText = isUnread ? 'Unread' : 'Read';
                    const rowClass = isUnread ? 'bg-yellow-50' : '';
                    
                    // Truncate long messages
                    const maxLength = 100;
                    const truncatedMessage = inquiry.message.length > maxLength ? 
                        inquiry.message.substring(0, maxLength) + '...' : 
                        inquiry.message;
                    
                    tableHTML += '<tr class="' + rowClass + '">' +
                        '<td class="px-6 py-4 text-sm text-gray-900">' +
                            '<div class="font-medium">' + (inquiry.customerName || 'N/A') + '</div>' +
                            (inquiry.username ? '<div class="text-xs text-blue-600">@' + inquiry.username + '</div>' : '') +
                            '<div class="text-xs text-gray-500">ID: ' + inquiry.telegramUserId + '</div>' +
                        '</td>' +
                        '<td class="px-6 py-4 text-sm text-gray-900" title="' + inquiry.message + '">' +
                            truncatedMessage +
                        '</td>' +
                        '<td class="px-6 py-4 text-sm text-gray-500">' +
                            '<div>' + date + '</div>' +
                            '<div class="text-xs">' + time + '</div>' +
                        '</td>' +
                        '<td class="px-6 py-4">' +
                            '<span class="px-2 py-1 text-xs font-semibold rounded-full ' + statusClass + '">' + statusText + '</span>' +
                        '</td>' +
                        '<td class="px-6 py-4 text-sm">' +
                            '<div class="flex flex-col space-y-1">' +
                                (inquiry.username ? 
                                    '<a href="https://t.me/' + inquiry.username + '" target="_blank" class="text-blue-600 hover:text-blue-800 text-xs bg-blue-100 px-2 py-1 rounded inline-flex items-center">' +
                                        'ðŸ’¬ @' + inquiry.username +
                                    '</a>' :
                                    '<span class="text-gray-400 text-xs">Username not captured</span>'
                                ) +
                                (isUnread ? 
                                    '<button onclick="markInquiryAsRead(\'' + inquiry.id + '\')" class="text-green-600 hover:text-green-800 text-xs bg-green-100 px-2 py-1 rounded">âœ“ Mark Read</button>' :
                                    '<span class="text-gray-500 text-xs">âœ“ Read</span>'
                                ) +
                            '</div>' +
                        '</td>' +
                    '</tr>';
                });
                
                tableHTML += '</tbody></table>';
                inquiriesList.innerHTML = tableHTML;
                
            } catch (error) {
                console.error('Error loading inquiries:', error);
                document.getElementById('inquiries-list').innerHTML = '<p class="text-red-500">Error loading inquiries</p>';
            }
        }

        async function markInquiryAsRead(inquiryId) {
            try {
                const response = await fetch('/api/inquiries/' + inquiryId, {
                    method: 'PATCH',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ isRead: true })
                });
                
                if (response.ok) {
                    loadInquiries(); // Reload to update display
                    loadDashboardData(); // Update dashboard counters
                    showNotification('Inquiry marked as read', 'success');
                } else {
                    showNotification('Error updating inquiry', 'error');
                }
            } catch (error) {
                console.error('Error updating inquiry:', error);
                showNotification('Error updating inquiry', 'error');
            }
        }

        async function loadBotSettings() {
            try {
                const response = await fetch('/api/bot/settings');
                const settings = await response.json();
                
                const welcomeSetting = settings.find(s => s.key === 'welcome_message');
                const storeSetting = settings.find(s => s.key === 'store_name');
                
                if (welcomeSetting) {
                    document.getElementById('welcome-message').value = welcomeSetting.value;
                }
                if (storeSetting) {
                    document.getElementById('store-name').value = storeSetting.value;
                }
            } catch (error) {
                console.error('Error loading bot settings:', error);
            }
        }

        async function updateBotSettings() {
            const welcomeMessage = document.getElementById('welcome-message').value;
            const storeName = document.getElementById('store-name').value;

            try {
                await Promise.all([
                    fetch('/api/bot/settings', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ key: 'welcome_message', value: welcomeMessage })
                    }),
                    fetch('/api/bot/settings', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ key: 'store_name', value: storeName })
                    })
                ]);
                
                showNotification('Bot settings updated successfully!', 'success');
            } catch (error) {
                showNotification('Error updating bot settings', 'error');
            }
        }

        async function checkBotStatus() {
            try {
                const response = await fetch('/api/bot/status');
                const status = await response.json();
                document.getElementById('bot-status-info').innerHTML = 
                    '<div class="bg-gray-50 p-3 rounded"><strong>Bot Status:</strong> <span class="text-green-600">' + status.status + '</span></div>';
            } catch (error) {
                document.getElementById('bot-status-info').innerHTML = '<p class="text-red-500">Error checking bot status</p>';
            }
        }

        async function restartBot() {
            try {
                const response = await fetch('/api/bot/restart', { method: 'POST' });
                const result = await response.json();
                document.getElementById('bot-status-info').innerHTML = 
                    '<div class="bg-green-50 p-3 rounded"><strong>Success:</strong> ' + result.message + '</div>';
            } catch (error) {
                document.getElementById('bot-status-info').innerHTML = '<p class="text-red-500">Error restarting bot</p>';
            }
        }

        // Form clearing functions
        function clearProductForm() {
            ['product-name', 'product-price', 'product-stock', 'product-category', 'product-description', 'product-specs'].forEach(id => {
                const element = document.getElementById(id);
                if (element) element.value = '';
            });
        }

        function clearCategoryForm() {
            ['category-name', 'category-description', 'category-order'].forEach(id => {
                const element = document.getElementById(id);
                if (element) element.value = '';
            });
        }

        function clearPaymentForm() {
            ['payment-name', 'payment-description', 'payment-info'].forEach(id => {
                const element = document.getElementById(id);
                if (element) element.value = '';
            });
            document.getElementById('payment-active').value = 'true';
        }

        function clearDeliveryForm() {
            ['delivery-name', 'delivery-price', 'delivery-days', 'delivery-description'].forEach(id => {
                const element = document.getElementById(id);
                if (element) element.value = '';
            });
        }

        // Broadcast functions
        function previewBroadcastImage(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('preview-img').src = e.target.result;
                    document.getElementById('broadcast-image-preview').style.display = 'block';
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        function removeBroadcastImage() {
            document.getElementById('broadcast-image').value = '';
            document.getElementById('broadcast-image-preview').style.display = 'none';
        }

        function previewBroadcast() {
            const message = document.getElementById('broadcast-message').value;
            const hasImage = document.getElementById('broadcast-image').files.length > 0;
            
            if (!message.trim()) {
                showNotification('Please enter a message', 'error');
                return;
            }

            let previewHTML = '<div class="space-y-3">';
            if (hasImage) {
                const imgSrc = document.getElementById('preview-img').src;
                previewHTML += '<img src="' + imgSrc + '" alt="Broadcast image" class="max-w-sm rounded-lg">';
            }
            previewHTML += '<p class="text-gray-800">' + message.replace(/\n/g, '<br>') + '</p>';
            previewHTML += '</div>';
            
            document.getElementById('preview-content').innerHTML = previewHTML;
            document.getElementById('broadcast-preview').style.display = 'block';
        }

        async function sendBroadcast() {
            const message = document.getElementById('broadcast-message').value;
            const imageFile = document.getElementById('broadcast-image').files[0];
            
            if (!message.trim()) {
                showNotification('Please enter a message', 'error');
                return;
            }

            if (!confirm('Are you sure you want to send this broadcast to all users?')) {
                return;
            }

            try {
                const formData = new FormData();
                formData.append('message', message);
                if (imageFile) {
                    formData.append('image', imageFile);
                }

                const response = await fetch('/api/broadcast', {
                    method: 'POST',
                    body: formData
                });

                if (response.ok) {
                    const result = await response.json();
                    showNotification('Broadcast sent to ' + result.sentCount + ' users!', 'success');
                    
                    // Clear form
                    document.getElementById('broadcast-message').value = '';
                    removeBroadcastImage();
                    document.getElementById('broadcast-preview').style.display = 'none';
                    
                    // Refresh history
                    loadBroadcastHistory();
                } else {
                    const error = await response.json();
                    showNotification('Error sending broadcast: ' + error.message, 'error');
                }
            } catch (error) {
                showNotification('Error sending broadcast', 'error');
            }
        }

        async function loadUserCount() {
            try {
                const response = await fetch('/api/users/count');
                const data = await response.json();
                document.getElementById('user-count').textContent = 'Will be sent to ' + data.count + ' users';
            } catch (error) {
                document.getElementById('user-count').textContent = 'Unable to load user count';
            }
        }

        async function loadBroadcastHistory() {
            try {
                const response = await fetch('/api/broadcast/history');
                const broadcasts = await response.json();
                const historyDiv = document.getElementById('broadcast-history');
                
                if (broadcasts.length === 0) {
                    historyDiv.innerHTML = '<p class="text-gray-500">No broadcasts sent yet</p>';
                    return;
                }

                let historyHTML = '<div class="space-y-4">';
                broadcasts.forEach(broadcast => {
                    const date = new Date(broadcast.createdAt).toLocaleString();
                    historyHTML += '<div class="border rounded-lg p-4">';
                    historyHTML += '<div class="flex justify-between items-start mb-2">';
                    historyHTML += '<span class="text-sm text-gray-500">' + date + '</span>';
                    historyHTML += '<span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded">' + broadcast.recipientCount + ' recipients</span>';
                    historyHTML += '</div>';
                    if (broadcast.hasImage) {
                        historyHTML += '<div class="mb-2"><span class="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded">ðŸ“· With Image</span></div>';
                    }
                    historyHTML += '<p class="text-gray-800">' + broadcast.message.substring(0, 150) + (broadcast.message.length > 150 ? '...' : '') + '</p>';
                    historyHTML += '</div>';
                });
                historyHTML += '</div>';
                
                historyDiv.innerHTML = historyHTML;
            } catch (error) {
                document.getElementById('broadcast-history').innerHTML = '<p class="text-red-500">Error loading broadcast history</p>';
            }
        }

        // Notification system
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 ' + 
                (type === 'success' ? 'bg-green-500 text-white' : 
                 type === 'error' ? 'bg-red-500 text-white' : 'bg-blue-500 text-white');
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Edit product functions
        async function editProduct(productId) {
            try {
                // Fetch product details
                const response = await fetch(`/api/products/${productId}`);
                const product = await response.json();
                
                // Populate the edit form
                document.getElementById('edit-product-id').value = product.id;
                document.getElementById('edit-product-name').value = product.name || '';
                document.getElementById('edit-product-description').value = product.description || '';
                document.getElementById('edit-product-price').value = product.price || '';
                document.getElementById('edit-product-compare-price').value = product.compareAtPrice || '';
                document.getElementById('edit-product-stock').value = product.stock || 0;
                document.getElementById('edit-product-unit').value = product.unit || 'piece';
                document.getElementById('edit-product-min-qty').value = product.minOrderQuantity || 1;
                document.getElementById('edit-product-max-qty').value = product.maxOrderQuantity || '';
                document.getElementById('edit-product-category').value = product.categoryId || '';
                document.getElementById('edit-product-specs').value = product.specifications || '{}';
                document.getElementById('edit-product-active').checked = product.isActive || false;
                document.getElementById('edit-product-featured').checked = product.isFeatured || false;
                
                // Handle current image
                if (product.imageUrl) {
                    document.getElementById('edit-current-image').classList.remove('hidden');
                    document.getElementById('edit-current-img').src = product.imageUrl;
                    document.getElementById('edit-product-image-url').value = product.imageUrl;
                } else {
                    document.getElementById('edit-current-image').classList.add('hidden');
                    document.getElementById('edit-product-image-url').value = '';
                }
                
                // Hide new image preview
                document.getElementById('edit-image-preview').classList.add('hidden');
                
                showEditProductForm();
            } catch (error) {
                console.error('Error loading product for edit:', error);
                showNotification('Error loading product details', 'error');
            }
        }

        async function updateProduct() {
            const productId = document.getElementById('edit-product-id').value;
            
            // Collect updated product data
            const productData = {
                name: document.getElementById('edit-product-name').value,
                description: document.getElementById('edit-product-description').value,
                price: parseFloat(document.getElementById('edit-product-price').value),
                compareAtPrice: document.getElementById('edit-product-compare-price').value ? 
                    parseFloat(document.getElementById('edit-product-compare-price').value) : null,
                stock: parseInt(document.getElementById('edit-product-stock').value),
                unit: document.getElementById('edit-product-unit').value,
                minOrderQuantity: parseInt(document.getElementById('edit-product-min-qty').value) || 1,
                maxOrderQuantity: document.getElementById('edit-product-max-qty').value ? 
                    parseInt(document.getElementById('edit-product-max-qty').value) : null,
                categoryId: document.getElementById('edit-product-category').value || null,
                imageUrl: document.getElementById('edit-product-image-url').value || null,
                specifications: document.getElementById('edit-product-specs').value || '{}',
                isActive: document.getElementById('edit-product-active').checked,
                isFeatured: document.getElementById('edit-product-featured').checked
            };

            // Validate required fields
            if (!productData.name || !productData.description || !productData.price || productData.stock < 0) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }

            try {
                JSON.parse(productData.specifications); // Validate JSON
                
                const response = await fetch(`/api/products/${productId}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(productData)
                });
                
                if (response.ok) {
                    hideEditProductForm();
                    loadProducts();
                    loadDashboardData();
                    showNotification('Product updated successfully!', 'success');
                } else {
                    const errorData = await response.json();
                    showNotification(`Error updating product: ${errorData.message || 'Unknown error'}`, 'error');
                }
            } catch (error) {
                console.error('Error updating product:', error);
                showNotification('Invalid JSON in specifications or server error', 'error');
            }
        }

        async function deleteProduct(productId) {
            if (!confirm('Are you sure you want to delete this product? This action cannot be undone.')) {
                return;
            }

            try {
                const response = await fetch(`/api/products/${productId}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    loadProducts();
                    loadDashboardData();
                    showNotification('Product deleted successfully!', 'success');
                } else {
                    showNotification('Error deleting product', 'error');
                }
            } catch (error) {
                console.error('Error deleting product:', error);
                showNotification('Error deleting product', 'error');
            }
        }

        // Edit form image upload functions
        function uploadEditProductImage() {
            document.getElementById('edit-product-image-input').click();
        }

        async function handleEditImageUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            if (file.size > 10 * 1024 * 1024) { // 10MB limit
                showNotification('File size must be less than 10MB', 'error');
                return;
            }

            try {
                // Get upload URL from server
                const uploadResponse = await fetch('/api/objects/upload', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                const { uploadURL } = await uploadResponse.json();

                // Upload file to object storage
                const fileResponse = await fetch(uploadURL, {
                    method: 'PUT',
                    body: file,
                    headers: {
                        'Content-Type': file.type
                    }
                });

                if (fileResponse.ok) {
                    // Extract object path from upload URL
                    const objectPath = '/objects/' + uploadURL.split('/').pop().split('?')[0];
                    
                    // Show preview and hide current image
                    const preview = document.getElementById('edit-image-preview');
                    const previewImg = document.getElementById('edit-preview-img');
                    previewImg.src = URL.createObjectURL(file);
                    document.getElementById('edit-product-image-url').value = objectPath;
                    preview.classList.remove('hidden');
                    document.getElementById('edit-current-image').classList.add('hidden');
                    
                    showNotification('New image uploaded successfully!', 'success');
                } else {
                    showNotification('Failed to upload image', 'error');
                }
            } catch (error) {
                console.error('Upload error:', error);
                showNotification('Error uploading image', 'error');
            }
        }

        function loadCategoriesForEditDropdown() {
            loadCategoriesForDropdown('edit-product-category');
        }
        
        function clearEditProductForm() {
            // Clear all edit form fields
            document.getElementById('edit-product-id').value = '';
            document.getElementById('edit-product-name').value = '';
            document.getElementById('edit-product-description').value = '';
            document.getElementById('edit-product-price').value = '';
            document.getElementById('edit-product-compare-price').value = '';
            document.getElementById('edit-product-stock').value = '';
            document.getElementById('edit-product-unit').value = 'piece';
            document.getElementById('edit-product-min-qty').value = '1';
            document.getElementById('edit-product-max-qty').value = '';
            document.getElementById('edit-product-category').value = '';
            document.getElementById('edit-product-specs').value = '';
            document.getElementById('edit-product-active').checked = false;
            document.getElementById('edit-product-featured').checked = false;
            
            // Clear image upload
            document.getElementById('edit-product-image-input').value = '';
            document.getElementById('edit-product-image-url').value = '';
            document.getElementById('edit-image-preview').classList.add('hidden');
            document.getElementById('edit-current-image').classList.add('hidden');
        }

        // Enhanced loadCategoriesForDropdown to support different dropdowns
        async function loadCategoriesForDropdown(selectId = 'product-category') {
            try {
                const response = await fetch('/api/categories');
                const categories = await response.json();
                const select = document.getElementById(selectId);
                
                // Clear existing options except the first one
                select.innerHTML = '<option value="">Select Category</option>';
                
                categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category.id;
                    option.textContent = category.name;
                    select.appendChild(option);
                });
            } catch (error) {
                console.error('Error loading categories:', error);
            }
        }

        // Edit category functions
        async function editCategory(categoryId) {
            try {
                // Fetch category details
                const response = await fetch(`/api/categories/${categoryId}`);
                const category = await response.json();
                
                // Populate the edit form
                document.getElementById('edit-category-id').value = category.id;
                document.getElementById('edit-category-name').value = category.name || '';
                document.getElementById('edit-category-display-order').value = category.displayOrder || 0;
                document.getElementById('edit-category-active').checked = category.isActive || false;
                
                showEditCategoryForm();
            } catch (error) {
                console.error('Error loading category for edit:', error);
                showNotification('Error loading category details', 'error');
            }
        }

        async function updateCategory() {
            const categoryId = document.getElementById('edit-category-id').value;
            
            // Collect updated category data
            const categoryData = {
                name: document.getElementById('edit-category-name').value,
                displayOrder: parseInt(document.getElementById('edit-category-display-order').value) || 0,
                isActive: document.getElementById('edit-category-active').checked
            };

            // Validate required fields
            if (!categoryData.name) {
                showNotification('Please enter a category name', 'error');
                return;
            }

            try {
                const response = await fetch(`/api/categories/${categoryId}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(categoryData)
                });
                
                if (response.ok) {
                    hideEditCategoryForm();
                    loadCategories();
                    loadDashboardData();
                    // Refresh category dropdowns in product forms
                    loadCategoriesForDropdown('product-category');
                    loadCategoriesForDropdown('edit-product-category');
                    showNotification('Category updated successfully!', 'success');
                } else {
                    const errorData = await response.json();
                    showNotification(`Error updating category: ${errorData.message || 'Unknown error'}`, 'error');
                }
            } catch (error) {
                console.error('Error updating category:', error);
                showNotification('Error updating category', 'error');
            }
        }

        async function deleteCategory(categoryId) {
            if (!confirm('Are you sure you want to delete this category? This action cannot be undone and will affect all products in this category.')) {
                return;
            }

            try {
                const response = await fetch(`/api/categories/${categoryId}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    loadCategories();
                    loadDashboardData();
                    // Refresh category dropdowns in product forms
                    loadCategoriesForDropdown('product-category');
                    loadCategoriesForDropdown('edit-product-category');
                    showNotification('Category deleted successfully!', 'success');
                } else {
                    const errorData = await response.json();
                    showNotification(`Error deleting category: ${errorData.message || 'Unknown error'}`, 'error');
                }
            } catch (error) {
                console.error('Error deleting category:', error);
                showNotification('Error deleting category', 'error');
            }
        }
        
        function clearEditCategoryForm() {
            // Clear all edit form fields
            document.getElementById('edit-category-id').value = '';
            document.getElementById('edit-category-name').value = '';
            document.getElementById('edit-category-display-order').value = '';
            document.getElementById('edit-category-active').checked = false;
        }

        // Edit payment method functions
        async function editPaymentMethod(paymentId) {
            try {
                // Fetch payment method details
                const response = await fetch(`/api/payment-methods/${paymentId}`);
                const payment = await response.json();
                
                // Populate the edit form
                document.getElementById('edit-payment-id').value = payment.id;
                document.getElementById('edit-payment-name').value = payment.name || '';
                document.getElementById('edit-payment-description').value = payment.description || '';
                document.getElementById('edit-payment-info').value = payment.paymentInfo || '';
                document.getElementById('edit-payment-active').checked = payment.isActive || false;
                
                showEditPaymentForm();
            } catch (error) {
                console.error('Error loading payment method for edit:', error);
                showNotification('Error loading payment method details', 'error');
            }
        }

        async function updatePaymentMethod() {
            const paymentId = document.getElementById('edit-payment-id').value;
            
            // Collect updated payment method data
            const paymentData = {
                name: document.getElementById('edit-payment-name').value,
                description: document.getElementById('edit-payment-description').value,
                paymentInfo: document.getElementById('edit-payment-info').value,
                isActive: document.getElementById('edit-payment-active').checked
            };

            // Validate required fields
            if (!paymentData.name) {
                showNotification('Please enter a payment method name', 'error');
                return;
            }

            try {
                const response = await fetch(`/api/payment-methods/${paymentId}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(paymentData)
                });
                
                if (response.ok) {
                    hideEditPaymentForm();
                    loadPaymentMethods();
                    loadDashboardData();
                    showNotification('Payment method updated successfully!', 'success');
                } else {
                    const errorData = await response.json();
                    showNotification(`Error updating payment method: ${errorData.message || 'Unknown error'}`, 'error');
                }
            } catch (error) {
                console.error('Error updating payment method:', error);
                showNotification('Error updating payment method', 'error');
            }
        }

        async function deletePaymentMethod(paymentId) {
            if (!confirm('Are you sure you want to delete this payment method? This action cannot be undone.')) {
                return;
            }

            try {
                const response = await fetch(`/api/payment-methods/${paymentId}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    loadPaymentMethods();
                    loadDashboardData();
                    showNotification('Payment method deleted successfully!', 'success');
                } else {
                    const errorData = await response.json();
                    showNotification(`Error deleting payment method: ${errorData.message || 'Unknown error'}`, 'error');
                }
            } catch (error) {
                console.error('Error deleting payment method:', error);
                showNotification('Error deleting payment method', 'error');
            }
        }

        function clearEditPaymentForm() {
            // Clear all edit form fields
            document.getElementById('edit-payment-id').value = '';
            document.getElementById('edit-payment-name').value = '';
            document.getElementById('edit-payment-description').value = '';
            document.getElementById('edit-payment-info').value = '';
            document.getElementById('edit-payment-active').checked = false;
        }

        // Edit delivery method functions
        async function editDeliveryMethod(deliveryId) {
            try {
                // Fetch delivery method details
                const response = await fetch(`/api/delivery-methods/${deliveryId}`);
                const delivery = await response.json();
                
                // Populate the edit form
                document.getElementById('edit-delivery-id').value = delivery.id;
                document.getElementById('edit-delivery-name').value = delivery.name || '';
                document.getElementById('edit-delivery-description').value = delivery.description || '';
                document.getElementById('edit-delivery-price').value = delivery.price || '';
                document.getElementById('edit-delivery-days').value = delivery.estimatedDays || '';
                document.getElementById('edit-delivery-active').checked = delivery.isActive || false;
                
                showEditDeliveryForm();
            } catch (error) {
                console.error('Error loading delivery method for edit:', error);
                showNotification('Error loading delivery method details', 'error');
            }
        }

        async function updateDeliveryMethod() {
            const deliveryId = document.getElementById('edit-delivery-id').value;
            
            // Collect updated delivery method data
            const deliveryData = {
                name: document.getElementById('edit-delivery-name').value,
                description: document.getElementById('edit-delivery-description').value,
                price: parseFloat(document.getElementById('edit-delivery-price').value),
                estimatedDays: parseInt(document.getElementById('edit-delivery-days').value),
                isActive: document.getElementById('edit-delivery-active').checked
            };

            // Validate required fields
            if (!deliveryData.name || isNaN(deliveryData.price) || isNaN(deliveryData.estimatedDays)) {
                showNotification('Please fill in all required fields with valid values', 'error');
                return;
            }

            try {
                const response = await fetch(`/api/delivery-methods/${deliveryId}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(deliveryData)
                });
                
                if (response.ok) {
                    hideEditDeliveryForm();
                    loadDeliveryMethods();
                    loadDashboardData();
                    showNotification('Delivery method updated successfully!', 'success');
                } else {
                    const errorData = await response.json();
                    showNotification(`Error updating delivery method: ${errorData.message || 'Unknown error'}`, 'error');
                }
            } catch (error) {
                console.error('Error updating delivery method:', error);
                showNotification('Error updating delivery method', 'error');
            }
        }

        async function deleteDeliveryMethod(deliveryId) {
            if (!confirm('Are you sure you want to delete this delivery method? This action cannot be undone.')) {
                return;
            }

            try {
                const response = await fetch(`/api/delivery-methods/${deliveryId}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    loadDeliveryMethods();
                    loadDashboardData();
                    showNotification('Delivery method deleted successfully!', 'success');
                } else {
                    const errorData = await response.json();
                    showNotification(`Error deleting delivery method: ${errorData.message || 'Unknown error'}`, 'error');
                }
            } catch (error) {
                console.error('Error deleting delivery method:', error);
                showNotification('Error deleting delivery method', 'error');
            }
        }

        function clearEditDeliveryForm() {
            // Clear all edit form fields
            document.getElementById('edit-delivery-id').value = '';
            document.getElementById('edit-delivery-name').value = '';
            document.getElementById('edit-delivery-description').value = '';
            document.getElementById('edit-delivery-price').value = '';
            document.getElementById('edit-delivery-days').value = '';
            document.getElementById('edit-delivery-active').checked = false;
        }

        window.onload = function() {
            loadDashboardData();
        };
        // Operator Support Functions
        let currentFilter = 'all';
        let supportSessions = [];

        async function loadSupportSessions() {
            try {
                const response = await fetch('/api/operator-sessions' + (currentFilter !== 'all' ? `?status=${currentFilter}` : ''));
                supportSessions = await response.json();
                renderSessionsList();
                updateSupportStats();
            } catch (error) {
                console.error('Error loading support sessions:', error);
                document.getElementById('sessions-list').innerHTML = '<p class="text-red-500 text-center py-8">Failed to load sessions</p>';
            }
        }

        function renderSessionsList() {
            const container = document.getElementById('sessions-list');
            
            if (supportSessions.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-8">No sessions found</p>';
                return;
            }

            const sessionsHtml = supportSessions.map(session => {
                const statusColors = {
                    waiting: 'bg-yellow-100 text-yellow-800',
                    active: 'bg-green-100 text-green-800',
                    resolved: 'bg-blue-100 text-blue-800'
                };
                
                const priorityColors = {
                    low: 'bg-gray-100 text-gray-800',
                    normal: 'bg-blue-100 text-blue-800',
                    high: 'bg-orange-100 text-orange-800',
                    urgent: 'bg-red-100 text-red-800'
                };

                return `
                    <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer" onclick="viewSession('${session.id}')">
                        <div class="flex items-center justify-between mb-2">
                            <div class="flex items-center space-x-2">
                                <span class="text-sm font-medium text-gray-900">${session.customerName}</span>
                                <span class="px-2 py-1 text-xs font-medium rounded-full ${statusColors[session.status]}">${session.status}</span>
                                <span class="px-2 py-1 text-xs font-medium rounded-full ${priorityColors[session.priority]}">${session.priority}</span>
                            </div>
                            <span class="text-sm text-gray-500">${new Date(session.createdAt).toLocaleString()}</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-2">${session.initialMessage}</p>
                        <div class="flex items-center justify-between text-xs text-gray-500">
                            <span>ID: ${session.id.substring(0, 8)}...</span>
                            ${session.operatorName ? `<span>Operator: ${session.operatorName}</span>` : '<span>Unassigned</span>'}
                        </div>
                    </div>
                `;
            }).join('');

            container.innerHTML = sessionsHtml;
        }

        function updateSupportStats() {
            const waiting = supportSessions.filter(s => s.status === 'waiting').length;
            const active = supportSessions.filter(s => s.status === 'active').length;
            const resolved = supportSessions.filter(s => s.status === 'resolved' && 
                new Date(s.resolvedAt || s.updatedAt).toDateString() === new Date().toDateString()).length;

            document.getElementById('waiting-sessions-count').textContent = waiting;
            document.getElementById('active-sessions-count').textContent = active;
            document.getElementById('resolved-sessions-count').textContent = resolved;
        }

        function filterSessions(status) {
            currentFilter = status;
            
            // Update button styles
            document.querySelectorAll('[id^="filter-"]').forEach(btn => {
                btn.className = 'px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500';
            });
            document.getElementById(`filter-${status}`).className = 'px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500';
            
            loadSupportSessions();
        }

        function refreshSessions() {
            loadSupportSessions();
        }

        async function viewSession(sessionId) {
            try {
                const response = await fetch(`/api/operator-sessions/${sessionId}`);
                const session = await response.json();
                
                const messagesResponse = await fetch(`/api/support-messages/${sessionId}`);
                const messages = await messagesResponse.json();
                
                showSessionModal(session, messages);
            } catch (error) {
                console.error('Error loading session details:', error);
                alert('Failed to load session details');
            }
        }

        function showSessionModal(session, messages) {
            const modal = document.getElementById('session-modal');
            const title = document.getElementById('session-modal-title');
            const content = document.getElementById('session-modal-content');
            const actions = document.getElementById('session-modal-actions');
            
            title.textContent = `Session: ${session.customerName}`;
            
            const statusColors = {
                waiting: 'bg-yellow-100 text-yellow-800',
                active: 'bg-green-100 text-green-800',
                resolved: 'bg-blue-100 text-blue-800'
            };
            
            // Messages history
            const messagesHtml = messages.map(msg => `
                <div class="p-3 rounded-lg ${msg.senderType === 'customer' ? 'bg-blue-50 ml-4' : 'bg-gray-50 mr-4'}">
                    <div class="flex justify-between items-center mb-1">
                        <span class="text-sm font-medium">${msg.senderName}</span>
                        <span class="text-xs text-gray-500">${new Date(msg.createdAt).toLocaleString()}</span>
                    </div>
                    <p class="text-sm">${msg.message}</p>
                </div>
            `).join('');
            
            content.innerHTML = `
                <div class="space-y-4">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Status</label>
                            <span class="px-2 py-1 text-xs font-medium rounded-full ${statusColors[session.status]}">${session.status}</span>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Priority</label>
                            <span class="text-sm">${session.priority}</span>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Category</label>
                            <span class="text-sm">${session.category}</span>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Operator</label>
                            <span class="text-sm">${session.operatorName || 'Not assigned'}</span>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Conversation History</label>
                        <div class="max-h-64 overflow-y-auto space-y-2 border rounded-lg p-3">
                            ${messagesHtml || '<p class="text-gray-500 text-center">No messages yet</p>'}
                        </div>
                    </div>
                    
                    ${session.status !== 'resolved' ? `
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Assign Operator</label>
                            <div class="flex space-x-2">
                                <input type="text" id="operator-name" placeholder="Operator name" class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                <button onclick="assignOperator('${session.id}')" class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700">Assign</button>
                            </div>
                        </div>
                    ` : ''}
                </div>
            `;
            
            // Action buttons
            actions.innerHTML = session.status !== 'resolved' 
                ? `<button onclick="closeSession('${session.id}')" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700">Close Session</button>`
                : '';
            
            modal.style.display = 'block';
        }

        async function assignOperator(sessionId) {
            const operatorName = document.getElementById('operator-name').value.trim();
            if (!operatorName) {
                alert('Please enter operator name');
                return;
            }
            
            try {
                const response = await fetch(`/api/operator-sessions/${sessionId}/assign`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ operatorName })
                });
                
                if (response.ok) {
                    closeSessionModal();
                    loadSupportSessions();
                    alert('Operator assigned successfully');
                } else {
                    alert('Failed to assign operator');
                }
            } catch (error) {
                console.error('Error assigning operator:', error);
                alert('Failed to assign operator');
            }
        }

        async function closeSession(sessionId) {
            if (!confirm('Are you sure you want to close this session?')) {
                return;
            }
            
            try {
                const response = await fetch(`/api/operator-sessions/${sessionId}/close`, {
                    method: 'PUT'
                });
                
                if (response.ok) {
                    closeSessionModal();
                    loadSupportSessions();
                    alert('Session closed successfully');
                } else {
                    alert('Failed to close session');
                }
            } catch (error) {
                console.error('Error closing session:', error);
                alert('Failed to close session');
            }
        }

        function closeSessionModal() {
            document.getElementById('session-modal').style.display = 'none';
        }

        // Load bot operators
        async function loadOperators() {
            try {
                const response = await fetch('/api/operators');
                const operators = await response.json();
                renderOperators(operators);
            } catch (error) {
                console.error('Error loading operators:', error);
                document.getElementById('operators-list').innerHTML = 
                    '<div class="text-center py-8"><div class="text-sm text-red-500">Failed to load operators</div></div>';
            }
        }

        function renderOperators(operators) {
            const container = document.getElementById('operators-list');
            
            if (operators.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8">
                        <div class="text-sm text-gray-500">No operators added yet</div>
                        <p class="text-xs text-gray-400 mt-1">Add operators to manage customer support</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = operators.map(operator => `
                <div class="border border-gray-200 rounded-lg p-4 flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <div class="flex-shrink-0">
                            <div class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center">
                                <span class="text-indigo-600 font-semibold">${operator.name.charAt(0).toUpperCase()}</span>
                            </div>
                        </div>
                        <div>
                            <div class="flex items-center space-x-2">
                                <h4 class="text-sm font-medium text-gray-900">${operator.name}</h4>
                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${
                                    operator.active ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'
                                }">
                                    ${operator.active ? 'Active' : 'Inactive'}
                                </span>
                            </div>
                            <div class="text-xs text-gray-500 space-y-1">
                                <div><strong>Username:</strong> ${operator.telegramUsername}</div>
                                ${operator.email ? `<div><strong>Email:</strong> ${operator.email}</div>` : ''}
                                ${operator.role ? `<div><strong>Role:</strong> ${operator.role}</div>` : ''}
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button onclick="toggleOperatorStatus(${operator.id})" class="px-3 py-1 text-xs font-medium ${
                            operator.active 
                                ? 'text-gray-700 bg-gray-100 hover:bg-gray-200' 
                                : 'text-green-700 bg-green-100 hover:bg-green-200'
                        } border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            ${operator.active ? 'Deactivate' : 'Activate'}
                        </button>
                        <button onclick="deleteOperator(${operator.id})" class="px-3 py-1 text-xs font-medium text-red-700 bg-red-100 border border-transparent rounded-md hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-red-500">
                            Delete
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Operator management functions
        function showAddOperatorModal() {
            document.getElementById('add-operator-modal').style.display = 'block';
        }

        function closeAddOperatorModal() {
            document.getElementById('add-operator-modal').style.display = 'none';
            // Reset form
            document.getElementById('operator-name').value = '';
            document.getElementById('operator-username').value = '';
            document.getElementById('operator-email').value = '';
            document.getElementById('operator-role').value = '';
            document.getElementById('operator-active').checked = true;
        }

        async function saveOperator(event) {
            event.preventDefault();
            
            const name = document.getElementById('operator-name').value.trim();
            const username = document.getElementById('operator-username').value.trim();
            const email = document.getElementById('operator-email').value.trim();
            const role = document.getElementById('operator-role').value.trim();
            const active = document.getElementById('operator-active').checked;

            if (!name || !username) {
                alert('Name and Telegram username are required');
                return;
            }

            // Ensure username starts with @
            const telegramUsername = username.startsWith('@') ? username : `@${username}`;

            try {
                const response = await fetch('/api/operators', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        name,
                        telegramUsername,
                        email: email || null,
                        role: role || null,
                        active
                    })
                });

                if (response.ok) {
                    await loadOperators();
                    closeAddOperatorModal();
                    showNotification('Operator added successfully!', 'success');
                } else {
                    const error = await response.json();
                    alert(error.error || 'Failed to add operator');
                }
            } catch (error) {
                console.error('Error adding operator:', error);
                alert('Failed to add operator');
            }
        }

        async function toggleOperatorStatus(operatorId) {
            try {
                const response = await fetch(`/api/operators/${operatorId}/toggle`, {
                    method: 'PUT'
                });

                if (response.ok) {
                    await loadOperators();
                    showNotification('Operator status updated!', 'success');
                } else {
                    alert('Failed to update operator status');
                }
            } catch (error) {
                console.error('Error updating operator status:', error);
                alert('Failed to update operator status');
            }
        }

        async function deleteOperator(operatorId) {
            if (!confirm('Are you sure you want to delete this operator?')) {
                return;
            }

            try {
                const response = await fetch(`/api/operators/${operatorId}`, {
                    method: 'DELETE'
                });

                if (response.ok) {
                    await loadOperators();
                    showNotification('Operator deleted successfully!', 'success');
                } else {
                    alert('Failed to delete operator');
                }
            } catch (error) {
                console.error('Error deleting operator:', error);
                alert('Failed to delete operator');
            }
        }

        // Initialize support section when it's shown
        function initSupportSection() {
            loadOperators();
            loadSupportSessions();
        }

        // Override showSection to initialize support section
        const originalShowSection = showSection;
        showSection = function(section) {
            originalShowSection(section);
            if (section === 'support') {
                initSupportSection();
            }
        };

    </script>

    <!-- Add Operator Modal -->
    <div id="add-operator-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full" style="display: none;">
        <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-1/2 shadow-lg rounded-md bg-white">
            <div class="mt-3">
                <h3 class="text-lg font-medium text-gray-900 mb-4">Add Bot Operator</h3>
                <form onsubmit="saveOperator(event)" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Operator Name</label>
                        <input type="text" id="operator-name" required placeholder="John Smith" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Telegram Username</label>
                        <input type="text" id="operator-username" required placeholder="@johnsmith" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        <p class="text-xs text-gray-500 mt-1">Include @ symbol</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Contact Email</label>
                        <input type="email" id="operator-email" placeholder="john@company.com" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Role/Department</label>
                        <input type="text" id="operator-role" placeholder="Customer Support" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="operator-active" checked class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                        <label for="operator-active" class="ml-2 block text-sm text-gray-700">Active (available for customer support)</label>
                    </div>
                    <div class="flex justify-end space-x-3 pt-4 border-t">
                        <button type="button" onclick="closeAddOperatorModal()" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            Cancel
                        </button>
                        <button type="submit" class="px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            Add Operator
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

</body>
</html>