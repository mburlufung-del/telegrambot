<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TeleShop Bot Admin Dashboard</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body { margin: 0; font-family: system-ui, -apple-system, sans-serif; }
        .dashboard { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .card { background: white; border-radius: 8px; padding: 20px; margin: 10px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .btn { background: #3b82f6; color: white; padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; }
        .btn:hover { background: #2563eb; }
        .status-online { color: #10b981; }
        .status-offline { color: #ef4444; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        function Dashboard() {
            const [botStatus, setBotStatus] = useState({ status: 'checking...', ready: false });
            const [stats, setStats] = useState({ products: 0, orders: 0, inquiries: 0 });
            
            useEffect(() => {
                // Fetch bot status
                fetch('/api/bot/status')
                    .then(res => res.json())
                    .then(data => setBotStatus(data))
                    .catch(err => setBotStatus({ status: 'offline', ready: false }));
                
                // Fetch basic stats
                Promise.all([
                    fetch('/api/products').then(r => r.json()).catch(() => []),
                    fetch('/api/orders').then(r => r.json()).catch(() => []),
                    fetch('/api/inquiries').then(r => r.json()).catch(() => [])
                ]).then(([products, orders, inquiries]) => {
                    setStats({
                        products: products.length || 0,
                        orders: orders.length || 0,
                        inquiries: inquiries.length || 0
                    });
                });
            }, []);
            
            const restartBot = async () => {
                try {
                    const response = await fetch('/api/bot/restart', { method: 'POST' });
                    if (response.ok) {
                        alert('Bot restarted successfully!');
                        // Refresh status
                        setTimeout(() => {
                            fetch('/api/bot/status')
                                .then(res => res.json())
                                .then(data => setBotStatus(data));
                        }, 2000);
                    }
                } catch (error) {
                    alert('Failed to restart bot');
                }
            };
            
            return (
                <div className="dashboard">
                    <h1 style={{fontSize: '2rem', fontWeight: 'bold', marginBottom: '20px'}}>
                        TeleShop Bot Admin Dashboard
                    </h1>
                    
                    <div className="card">
                        <h2 style={{fontSize: '1.5rem', marginBottom: '10px'}}>Bot Status</h2>
                        <p>
                            Status: <span className={botStatus.status === 'online' ? 'status-online' : 'status-offline'}>
                                {botStatus.status}
                            </span>
                        </p>
                        <button className="btn" onClick={restartBot}>
                            Restart Bot
                        </button>
                    </div>
                    
                    <div className="card">
                        <h2 style={{fontSize: '1.5rem', marginBottom: '10px'}}>Quick Stats</h2>
                        <div style={{display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '20px'}}>
                            <div>
                                <div style={{fontSize: '2rem', fontWeight: 'bold', color: '#3b82f6'}}>
                                    {stats.products}
                                </div>
                                <div>Products</div>
                            </div>
                            <div>
                                <div style={{fontSize: '2rem', fontWeight: 'bold', color: '#10b981'}}>
                                    {stats.orders}
                                </div>
                                <div>Orders</div>
                            </div>
                            <div>
                                <div style={{fontSize: '2rem', fontWeight: 'bold', color: '#f59e0b'}}>
                                    {stats.inquiries}
                                </div>
                                <div>Inquiries</div>
                            </div>
                        </div>
                    </div>
                    
                    <div className="card">
                        <h2 style={{fontSize: '1.5rem', marginBottom: '10px'}}>Quick Actions</h2>
                        <div style={{display: 'flex', gap: '10px', flexWrap: 'wrap'}}>
                            <button className="btn" onClick={() => window.open('/api/products', '_blank')}>
                                View Products API
                            </button>
                            <button className="btn" onClick={() => window.open('/api/orders', '_blank')}>
                                View Orders API
                            </button>
                            <button className="btn" onClick={() => window.open('/api/inquiries', '_blank')}>
                                View Inquiries API
                            </button>
                        </div>
                    </div>
                    
                    <div className="card">
                        <h2 style={{fontSize: '1.5rem', marginBottom: '10px'}}>System Status</h2>
                        <p>✅ Backend API is running</p>
                        <p className={botStatus.status === 'online' ? 'status-online' : 'status-offline'}>
                            {botStatus.status === 'online' ? '✅' : '❌'} Telegram Bot is {botStatus.status}
                        </p>
                        <p>✅ Database is connected</p>
                        <p>✅ Dashboard is accessible</p>
                    </div>
                </div>
            );
        }
        
        ReactDOM.render(<Dashboard />, document.getElementById('root'));
    </script>
</body>
</html>